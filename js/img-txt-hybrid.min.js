function createAndAppendImgDivs(e,t,n,r){"use strict";var i,s,o;if(e!==undefined){o=e}else{o=function(){var e,t;e=Math.random().toString().slice(2);t=Math.random().toString().slice(2);return e+"_"+t}}i=$(document.createElement("div"));i.attr({id:o(),"class":"upload-image"});s=$(document.createElement("img"));s.attr("src",t);i.objectSettings(RESIZE_OBJECT_SETTINGS);i.css(n);s.css(IMG_SETTINGS);i.append(s);r.append(i)}function stringConvJStoHTML(e){"use strict";var t,n,r,i;if(is_firefox){return e.replace(/\n/g,"<br>")}t="";n=e.split("\n");for(i=0;i<n.length;i++){if(n[i]===""){r="<br>"}else{r=n[i].replace(" ","&nbsp;")}t+="<div>"+r+"</div>"}return t}var is_chrome=navigator.userAgent.indexOf("Chrome")>-1;var is_explorer=window.hasOwnProperty("ActiveXObject");var is_firefox=navigator.userAgent.indexOf("Firefox")>-1;var is_safari=navigator.userAgent.indexOf("Safari")>-1;var is_Opera=navigator.userAgent.indexOf("Presto")>-1;if(is_chrome&&is_safari){is_safari=false}var RESIZE_OBJECT_SETTINGS,IMG_SETTINGS;(function(e,t,n){"use strict";function r(n,r,i){var s,o,u,a,f,l,c,h,p;h=Math.random().toString().slice(2);p=Math.random().toString().slice(2);h+="_"+p;if(r!==undefined){a=new Image;s=e(a);s.attr("src",n)}else{s=e(n)}s[0].onload=function(){if(s[0].width<=0||s[0].height<=0){alert("Upload Error! Try again\n");return false}u=t.createElement("div");u.setAttribute("contenteditable","false");u.setAttribute("class","upload-image");o=e(u);c=parseInt(i.css("height").replace("px",""),10);if(s[0].height>c){l=c/2;f=s[0].width/s[0].height*l}else{l=s[0].height;f=s[0].width}o.css({top:i.scrollTop().toString()+"px",left:"10px",width:f+"px",height:l+"px"});o.attr("id",h);o.objectSettings(RESIZE_OBJECT_SETTINGS);s.objectSettings(IMG_SETTINGS);o.append(s);o.imgInteract();i.append(o)}}function i(e,t){function u(e){var n=new FileReader;n.onload=function(i){i.preventDefault();i.stopPropagation();r(n.result,e,t,RESIZE_OBJECT_SETTINGS,IMG_SETTINGS)};n.onerror=function(){alert("Upload Failed! Try again.")};n.readAsDataURL(e)}var n,i,s,o;e.preventDefault();e.stopPropagation();n=e.originalEvent.dataTransfer;i=n.files;if(i.length<=0){s=e.originalEvent.dataTransfer.getData("URL")}if(s!==undefined){alert("Try copy-pasting the image instead!")}else{for(o=0;o<i.length;o++){u(i[o])}}t.attr("contenteditable","true")}function s(e,t){var i,s,o,u;e.preventDefault();if(is_explorer){s=n.clipboardData.getData("URL");i="<img src='"+s+"'/>";u=n.clipboardData.getData("text");if(s===""||s===undefined){o=u}else{o=i}}else if(!is_explorer){s=e.originalEvent.clipboardData.getData("text/html");u=e.originalEvent.clipboardData.getData("text/plain");if(is_chrome||is_safari){i=s.match(/<!--StartFragment-->(.*)<!--EndFragment-->/);if(i!==null){o=i[1]}}else{i=s;o=i}if(s===""||o===undefined){if(u===""){alert("Try dragging and dropping the image!");u=""}o=u}}if(o.indexOf("<img")>-1){r(o,undefined,t,RESIZE_OBJECT_SETTINGS,IMG_SETTINGS)}else{try{n.document.execCommand("insertText",false,o)}catch(a){}}}e.fn.suppressDefaults=function(){this.on("dragover",function(e){e.stopPropagation();e.preventDefault()});this.on("dragenter",function(e){e.stopPropagation();e.preventDefault()})};e.fn.attachDeleteButton=function(){var t,n,r;t=this;if(this.find(".delImg").length<1){n=document.createElement("input");n.setAttribute("type","submit");n.setAttribute("value","X");n.setAttribute("class","delImg");r=e(n);r.attr("id","delImg_"+t[0].id);r.css({position:"relative",bottom:"99%","float":"right",right:"1px",display:"none"});t.append(r)}else{r=e("#"+"delImg_"+t[0].id.replace(".","\\."));console.log(r)}t.hover(function(){r.show()},function(){r.hide()});r.on("click",function(t){t.preventDefault();t.stopPropagation();e(this).parent().remove()})};e.fn.imgEvent=function(){var e=this;e.on("drop",function(t){i(t,e,RESIZE_OBJECT_SETTINGS,IMG_SETTINGS)});e.on("paste",function(t){s(t,e,RESIZE_OBJECT_SETTINGS,IMG_SETTINGS)})};e.fn.tabEnable=function(){var e=this;e.on("keydown",function(e){if(e.which===9){e.preventDefault();n.document.execCommand("insertText",false,"    ")}})};e.fn.imgInteract=function(){this.draggable({containment:"parent"});this.resizable({containment:"parent",handles:"s, e, se, w, sw"});this.attachDeleteButton();if(is_chrome){this.find(".ui-icon-gripsmall-diagonal-se").attr({"class":"ui-resizable-handle ui-resizable-se ui-icon-gripsmall-diagonal-se"})}};e.fn.primeDivs=function(){if(!is_firefox){this.html("<div><br></div>")}else{this.html("<p></p>")}};e.fn.objectSettings=function(e){var t=this;t.css(e)}})(jQuery,document,window);$.fn.refreshImgInteractions=function(){"use strict";var e,t;e=this.find(".upload-image");for(t=0;t<e.length;t++){$(e[t]).contents().remove("div.ui-resizable-handle");$(e[t]).unbind();$(e[t]).imgInteract()}e.on("click",function(){e.css("z-index","0");$(this).css("z-index","10")})};$.fn.imgSrc=function(){"use strict";var e,t,n,r,i,s,o,u,a,f,l,c;e=[];t=this.find("img");for(c=0;c<t.length;c++){r=$(t[c]).parent().attr("id");i=$(t[c]).parent().css("top");s=$(t[c]).parent().css("left");o=$(t[c]).parent().css("height");u=$(t[c]).parent().css("width");a=t[c].src;if(a.indexOf("base64")>-1){f=a.indexOf("base64")+7;l=a.slice(f,a.length)}else{l=a}n={id:r,top:i,left:s,height:o,width:u,data:l};e.push(n)}return e};$.fn.stringConvHTMLtoJS=function(){"use strict";var e,t,n,r,i,s;e="";t="";if(!is_firefox){r=this.contents().not(".upload-image");for(n=0;n<r.length;n++){t+=jQuery(r[n]).text()+"\n"}t=t.replace(/&nbsp;/g," ");e+=t}else{i=this.html();s=i.indexOf("<div");e+=i.slice(0,s).replace(/<br>/g,"\n")}return e};$.fn.imgTxtHybrid=function(e){"use strict";var t,n;t={overflow:"hidden",position:"absolute","white-space":"pre-wrap",display:"inline-block"};RESIZE_OBJECT_SETTINGS=t;if(e!==undefined){try{RESIZE_OBJECT_SETTINGS=t;for(n in e){RESIZE_OBJECT_SETTINGS[n]=e[n]}}catch(r){console.log(r)}}IMG_SETTINGS={display:"block",width:100+"%",height:100+"%"};this.attr("contenteditable","true");this.css({position:"relative",overflow:"auto"});this.suppressDefaults();this.primeDivs();this.imgEvent();this.tabEnable()}